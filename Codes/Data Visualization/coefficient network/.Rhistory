knitr::opts_chunk$set(echo = TRUE,eval=TRUE, message=FALSE, warning=FALSE)
library(readxl)
library(magrittr)
library(dplyr)
library(ggplot2)
library(ggthemes)
library(tidyverse)
library(jsonlite)
library(tidyr)
library(tigris)
library(tidytext)
library(textdata)
library(tm)
library(quanteda)
library(rvest)
library(stringr)
library(SnowballC)
library(wordcloud)
library(plotrix)
library(qdapDictionaries)
library(formattable)
library(stringr)
library(DT)
library(network)
library(ggnetwork)
library(igraph)
library(RColorBrewer)
library(randomcoloR)
library(stringi)
library(igraph)
library(ggraph)
library(graphlayouts)
edgelist <- read.csv("~/Documents/GitHub/G5055_Practicum_Project2/Data/Text_Model_Data/edgelist.csv")
edgelist
nodes <- edgelist %>%
select(indicator, related_indicator)
nodes <- data.frame(indicatorname = unlist(nodes, use.names = FALSE))
nodes <- distinct(nodes)
nodes$goal <- stri_match_first_regex(nodes$indicator, "(.*?)\\.")[,2]
nodes$goal <-as.numeric(nodes$goal)
nodes
g<-graph_from_data_frame(edgelist, directed=FALSE, vertices=nodes)
#Add attributes
E(g)$weight<-E(g)$similarity_score
V(g)$in_degree<-degree(g, mode="in")
colrs<-c("#ea1d2d", "#d19f2a","#2d9a47", "#c22033","#ef412a", "#00add9", "#fdb714", "#8f1838", "#f36e24", "#e01a83", "#f99d25", "#cd8b2a", "#48773c", "#007dbb", "#40ae49",  "#00558a", "#1a3668")
V(g)$color<-colrs[V(g)$goal]
#Plot graph
plot(g, vertex.label=NA, edge.color="gray77", vertex.color=V(g)$color, vertex.size=V(g)$in_degree, edge.width=E(g)$weight*10, layout=layout_nicely(g))
plot(g, vertex.label.color="black", vertex.label.cex=2.5, edge.color="gray77", vertex.color=V(g)$color, vertex.size=V(g)$in_degree, edge.width=E(g)$weight*10, layout=layout_nicely(g))
#legend(x=-11, y=-11, c("Goal 1","Goal 2","Goal 3","Goal 4","Goal 5","Goal 6","Goal 7","Goal 8","Goal 9","Goal 10","Goal 11", "Goal 12","Goal 13", "Goal 14", "Goal 15", "Goal 16", "Goal 17"), pch=20, col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
edgelistindo <- read.csv("~/Documents/GitHub/G5055_Practicum_Project2/Data/PCA_results/indo_coefficients.csv")
#Some preprocessing
edgelistindo<-edgelistindo%>%
select(Var1, Var2, abs)%>%
filter(Var1!=Var2)
edgelistindo
indonodes <- edgelistindo %>%
select(Var1, Var2)
indonodes <- data.frame(indicatorname = unlist(indonodes, use.names = FALSE))
indonodes <- distinct(indonodes)
indonodes$goal <- stri_match_first_regex(indonodes$indicator, "(.*?)\\.")[,2]
indonodes$goal <-as.numeric(indonodes$goal)
indonodes
edgelistguate <- read.csv("~/Documents/GitHub/G5055_Practicum_Project2/Data/PCA_results/gua_coefficients.csv")
#Some preprocessing
edgelistguate<-edgelistguate%>%
select(Var1, Var2, abs)%>%
filter(Var1!=Var2)
edgelistguate
guatenodes <- edgelistguate %>%
select(Var1, Var2)
guatenodes <- data.frame(indicatorname = unlist(guatenodes, use.names = FALSE))
guatenodes <- distinct(guatenodes)
guatenodes$goal <- stri_match_first_regex(guatenodes$indicator, "(.*?)\\.")[,2]
guatenodes$goal <-as.numeric(guatenodes$goal)
guatenodes
g2<-graph_from_data_frame(edgelistindo, directed=FALSE, vertices=indonodes)
#Add attributes
E(g2)$weight<-E(g2)$abs
V(g2)$in_degree<-degree(g2, mode="in")
colrs<-c("#DA5891", "#757CCE", "#D948D1", "#E2B94F", "#E06444", "#909276", "#7BBADD", "#874CDD", "#D6DED5", "#7EE55C", "#D9E19E", "#D69893", "#D0E357", "#CE83D8", "#82E1D3", "#73DA9C", "#CFB2D7")
V(g2)$color<-colrs[V(g2)$goal]
#Plot graph
plot(g2, vertex.label.color="black", vertex.label.cex=2.5, edge.color="gray77", vertex.color=V(g2)$color, vertex.size=V(g2)$in_degree/10, edge.width=E(g2)$weight, layout=layout_nicely(g2))
g3<-graph_from_data_frame(edgelistguate, directed=FALSE, vertices=guatenodes)
#Add attributes
E(g3)$weight<-E(g3)$abs
V(g3)$in_degree<-degree(g3, mode="in")
colrs<-c("#DA5891", "#757CCE", "#D948D1", "#E2B94F", "#E06444", "#909276", "#7BBADD", "#874CDD", "#D6DED5", "#7EE55C", "#D9E19E", "#D69893", "#D0E357", "#CE83D8", "#82E1D3", "#73DA9C", "#CFB2D7")
V(g3)$color<-colrs[V(g3)$goal]
#Plot graph
plot(g3, vertex.label.color="black", vertex.label.cex=2.5, edge.color="gray77", vertex.color=V(g3)$color, vertex.size=V(g3)$in_degree/10, edge.width=E(g3)$weight, layout=layout_nicely(g3))
g<-graph_from_data_frame(edgelist, directed=FALSE, vertices=nodes)
#Add attributes
E(g)$weight<-E(g)$similarity_score
V(g)$in_degree<-degree(g, mode="in")
colrs<-c("#ea1d2d", "#d19f2a","#2d9a47", "#c22033","#ef412a", "#00add9", "#fdb714", "#8f1838", "#f36e24", "#e01a83", "#f99d25", "#cd8b2a", "#48773c", "#007dbb", "#40ae49",  "#00558a", "#1a3668")
V(g)$color<-colrs[V(g)$goal]
#Plot graph
plot(g, vertex.label=NA, edge.color="gray77", vertex.color=V(g)$color, vertex.size=V(g)$in_degree, edge.width=E(g)$weight*10, layout=layout_nicely(g))
plot(g, vertex.label.color="black", vertex.label.cex=2.5, edge.color="gray77", vertex.color=V(g)$color, vertex.size=V(g)$in_degree, edge.width=E(g)$weight*10, layout=layout_nicely(g))
#legend(x=-11, y=-11, c("Goal 1","Goal 2","Goal 3","Goal 4","Goal 5","Goal 6","Goal 7","Goal 8","Goal 9","Goal 10","Goal 11", "Goal 12","Goal 13", "Goal 14", "Goal 15", "Goal 16", "Goal 17"), pch=20, col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
g<-graph_from_data_frame(edgelist, directed=FALSE, vertices=nodes)
#Add attributes
E(g)$weight<-E(g)$similarity_score
V(g)$in_degree<-degree(g, mode="in")
colrs<-c("#ea1d2d", "#d19f2a","#2d9a47", "#c22033","#ef412a", "#00add9", "#fdb714", "#8f1838", "#f36e24", "#e01a83", "#f99d25", "#cd8b2a", "#48773c", "#007dbb", "#40ae49",  "#00558a", "#1a3668")
V(g)$color<-colrs[V(g)$goal]
#Plot graph
plot(g, vertex.label=NA, edge.color="gray77", vertex.color=V(g)$color, vertex.size=V(g)$in_degree, edge.width=E(g)$weight*10, layout=layout_nicely(g))
plot(g, vertex.label.color="black", vertex.label.cex=2.5, edge.color="gray77", vertex.color=V(g)$color, vertex.size=V(g)$in_degree, edge.width=E(g)$weight*10, layout=layout_nicely(g))
#legend(x=-11, y=-11, c("Goal 1","Goal 2","Goal 3","Goal 4","Goal 5","Goal 6","Goal 7","Goal 8","Goal 9","Goal 10","Goal 11", "Goal 12","Goal 13", "Goal 14", "Goal 15", "Goal 16", "Goal 17"), pch=20, col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
g<-graph_from_data_frame(edgelist, directed=FALSE, vertices=nodes)
#Add attributes
E(g)$weight<-E(g)$similarity_score
V(g)$in_degree<-degree(g, mode="in")
colrs<-c("#ea1d2d", "#d19f2a","#2d9a47", "#c22033","#ef412a", "#00add9", "#fdb714", "#8f1838", "#f36e24", "#e01a83", "#f99d25", "#cd8b2a", "#48773c", "#007dbb", "#40ae49",  "#00558a", "#1a3668")
V(g)$color<-colrs[V(g)$goal]
#Plot graph
plot(g, vertex.label=NA, edge.color="gray77", vertex.color=V(g)$color, vertex.size=V(g)$in_degree, edge.width=E(g)$weight*10, layout=layout_nicely(g))
plot(g, vertex.label.color="black", vertex.label.cex=2.5, edge.color="gray77", vertex.color=V(g)$color, vertex.size=V(g)$in_degree, edge.width=E(g)$weight*10, layout=layout_nicely(g))
#legend(x=-11, y=-11, c("Goal 1","Goal 2","Goal 3","Goal 4","Goal 5","Goal 6","Goal 7","Goal 8","Goal 9","Goal 10","Goal 11", "Goal 12","Goal 13", "Goal 14", "Goal 15", "Goal 16", "Goal 17"), pch=20, col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
g<-graph_from_data_frame(edgelist, directed=FALSE, vertices=nodes)
#Add attributes
E(g)$weight<-E(g)$similarity_score
V(g)$in_degree<-degree(g, mode="in")
colrs<-c("#ea1d2d", "#d19f2a","#2d9a47", "#c22033","#ef412a", "#00add9", "#fdb714", "#8f1838", "#f36e24", "#e01a83", "#f99d25", "#cd8b2a", "#48773c", "#007dbb", "#40ae49",  "#00558a", "#1a3668")
V(g)$color<-colrs[V(g)$goal]
#Plot graph
plot(g, vertex.label=NA, edge.color="gray77", vertex.color=V(g)$color, vertex.size=V(g)$in_degree, edge.width=E(g)$weight*10, layout=layout_nicely(g))
plot(g, vertex.label.color="black", vertex.label.cex=2.5, edge.color="gray77", vertex.color=V(g)$color, vertex.size=V(g)$in_degree, edge.width=E(g)$weight*10, layout=layout_nicely(g))
#legend(x=-11, y=-11, c("Goal 1","Goal 2","Goal 3","Goal 4","Goal 5","Goal 6","Goal 7","Goal 8","Goal 9","Goal 10","Goal 11", "Goal 12","Goal 13", "Goal 14", "Goal 15", "Goal 16", "Goal 17"), pch=20, col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
g<-graph_from_data_frame(edgelist, directed=FALSE, vertices=nodes)
#Add attributes
E(g)$weight<-E(g)$similarity_score
V(g)$in_degree<-degree(g, mode="in")
colrs<-c("#ea1d2d", "#d19f2a","#2d9a47", "#c22033","#ef412a", "#00add9", "#fdb714", "#8f1838", "#f36e24", "#e01a83", "#f99d25", "#cd8b2a", "#48773c", "#007dbb", "#40ae49",  "#00558a", "#1a3668")
V(g)$color<-colrs[V(g)$goal]
#Plot graph
plot(g, vertex.label=NA, edge.color="gray77", vertex.color=V(g)$color, vertex.size=V(g)$in_degree, edge.width=E(g)$weight*10, layout=layout_nicely(g))
plot(g, vertex.label.color="black", vertex.label.cex=2.5, edge.color="gray77", vertex.color=V(g)$color, vertex.size=V(g)$in_degree, edge.width=E(g)$weight*10, layout=layout_nicely(g))
#legend(x=-11, y=-11, c("Goal 1","Goal 2","Goal 3","Goal 4","Goal 5","Goal 6","Goal 7","Goal 8","Goal 9","Goal 10","Goal 11", "Goal 12","Goal 13", "Goal 14", "Goal 15", "Goal 16", "Goal 17"), pch=20, col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
edgelistindo <- read.csv("~/Documents/GitHub/G5055_Practicum_Project2/Data/PCA_results/indo_coefficients.csv")
edgelistindo
edgelistindo <- read.csv("~/Documents/GitHub/G5055_Practicum_Project2/Data/PCA_results/indo_coefficients.csv")
#Some preprocessing
edgelistindo<-edgelistindo%>%
select(Var1, Var2, tie)%>%
filter(Var1!=Var2)
edgelistindo
indonodes <- edgelistindo %>%
select(Var1, Var2)
indonodes <- data.frame(indicatorname = unlist(indonodes, use.names = FALSE))
indonodes <- distinct(indonodes)
indonodes$goal <- stri_match_first_regex(indonodes$indicator, "(.*?)\\.")[,2]
indonodes$goal <-as.numeric(indonodes$goal)
indonodes
edgelistguate <- read.csv("~/Documents/GitHub/G5055_Practicum_Project2/Data/PCA_results/gua_coefficients.csv")
#Some preprocessing
edgelistguate<-edgelistguate%>%
select(Var1, Var2, tie)%>%
filter(Var1!=Var2)
edgelistguate
guatenodes <- edgelistguate %>%
select(Var1, Var2)
guatenodes <- data.frame(indicatorname = unlist(guatenodes, use.names = FALSE))
guatenodes <- distinct(guatenodes)
guatenodes$goal <- stri_match_first_regex(guatenodes$indicator, "(.*?)\\.")[,2]
guatenodes$goal <-as.numeric(guatenodes$goal)
guatenodes
g2<-graph_from_data_frame(edgelistindo, directed=FALSE, vertices=indonodes)
#Add attributes
E(g2)$weight<-E(g2)$abs
g2<-graph_from_data_frame(edgelistindo, directed=FALSE, vertices=indonodes)
#Add attributes
E(g2)$weight<-E(g2)$tie
V(g2)$in_degree<-degree(g2, mode="in")
colrs<-c("#ea1d2d", "#d19f2a","#2d9a47", "#c22033","#ef412a", "#00add9", "#fdb714", "#8f1838", "#f36e24", "#e01a83", "#f99d25", "#cd8b2a", "#48773c", "#007dbb", "#40ae49",  "#00558a", "#1a3668")
V(g2)$color<-colrs[V(g2)$goal]
#Plot graph
plot(g2, vertex.label=NA, edge.color="gray77", vertex.color=V(g2)$color, vertex.size=V(g2)$in_degree/10, edge.width=E(g2)$weight, layout=layout_nicely(g2))
plot(g2, vertex.label.color="black", vertex.label.cex=2.5, edge.color="gray77", vertex.color=V(g2)$color, vertex.size=V(g2)$in_degree/10, edge.width=E(g2)$weight, layout=layout_nicely(g2))
g2<-graph_from_data_frame(edgelistindo, directed=FALSE, vertices=indonodes)
#Add attributes
E(g2)$weight<-E(g2)$tie
V(g2)$in_degree<-degree(g2, mode="in")
colrs<-c("#ea1d2d", "#d19f2a","#2d9a47", "#c22033","#ef412a", "#00add9", "#fdb714", "#8f1838", "#f36e24", "#e01a83", "#f99d25", "#cd8b2a", "#48773c", "#007dbb", "#40ae49",  "#00558a", "#1a3668")
V(g2)$color<-colrs[V(g2)$goal]
#Plot graph
plot(g2, vertex.label=NA, edge.color="gray77", vertex.color=V(g2)$color, vertex.size=V(g2)$in_degree/100, edge.width=E(g2)$weight, layout=layout_nicely(g2))
plot(g2, vertex.label.color="black", vertex.label.cex=2.5, edge.color="gray77", vertex.color=V(g2)$color, vertex.size=V(g2)$in_degree/10, edge.width=E(g2)$weight, layout=layout_nicely(g2))
g2<-graph_from_data_frame(edgelistindo, directed=FALSE, vertices=indonodes)
#Add attributes
E(g2)$weight<-E(g2)$tie
V(g2)$in_degree<-degree(g2, mode="in")
colrs<-c("#ea1d2d", "#d19f2a","#2d9a47", "#c22033","#ef412a", "#00add9", "#fdb714", "#8f1838", "#f36e24", "#e01a83", "#f99d25", "#cd8b2a", "#48773c", "#007dbb", "#40ae49",  "#00558a", "#1a3668")
V(g2)$color<-colrs[V(g2)$goal]
#Plot graph
plot(g2, vertex.label=NA, edge.color="gray77", vertex.color=V(g2)$color, vertex.size=V(g2)$in_degree/10, edge.width=E(g2)$weight, layout=layout_nicely(g2))
plot(g2, vertex.label.color="black", vertex.label.cex=2.5, edge.color="gray77", vertex.color=V(g2)$color, vertex.size=V(g2)$in_degree/10, edge.width=E(g2)$weight, layout=layout_nicely(g2))
g2<-graph_from_data_frame(edgelistindo, directed=FALSE, vertices=indonodes)
#Add attributes
E(g2)$weight<-E(g2)$tie
V(g2)$in_degree<-degree(g2, mode="in")
colrs<-c("#ea1d2d", "#d19f2a","#2d9a47", "#c22033","#ef412a", "#00add9", "#fdb714", "#8f1838", "#f36e24", "#e01a83", "#f99d25", "#cd8b2a", "#48773c", "#007dbb", "#40ae49",  "#00558a", "#1a3668")
V(g2)$color<-colrs[V(g2)$goal]
#Plot graph
plot(g2, vertex.label=NA, edge.color="gray77", vertex.color=V(g2)$color, vertex.size=V(g2)$in_degree/50, edge.width=E(g2)$weight, layout=layout_nicely(g2))
plot(g2, vertex.label.color="black", vertex.label.cex=2.5, edge.color="gray77", vertex.color=V(g2)$color, vertex.size=V(g2)$in_degree/10, edge.width=E(g2)$weight, layout=layout_nicely(g2))
g2<-graph_from_data_frame(edgelistindo, directed=FALSE, vertices=indonodes)
#Add attributes
E(g2)$weight<-E(g2)$tie
V(g2)$in_degree<-degree(g2, mode="in")
colrs<-c("#ea1d2d", "#d19f2a","#2d9a47", "#c22033","#ef412a", "#00add9", "#fdb714", "#8f1838", "#f36e24", "#e01a83", "#f99d25", "#cd8b2a", "#48773c", "#007dbb", "#40ae49",  "#00558a", "#1a3668")
V(g2)$color<-colrs[V(g2)$goal]
#Plot graph
plot(g2, vertex.label=NA, edge.color="gray77", vertex.color=V(g2)$color, vertex.size=V(g2)$in_degree/20, edge.width=E(g2)$weight, layout=layout_nicely(g2))
plot(g2, vertex.label.color="black", vertex.label.cex=2.5, edge.color="gray77", vertex.color=V(g2)$color, vertex.size=V(g2)$in_degree/10, edge.width=E(g2)$weight, layout=layout_nicely(g2))
knitr::opts_chunk$set(echo = TRUE,eval=TRUE, message=FALSE, warning=FALSE)
